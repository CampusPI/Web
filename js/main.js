"use strict";angular.module("tvApp",["ngResource","btford.modal","ngRoute","googleOauth"]).config(function($routeProvider){$routeProvider.when("/",{templateUrl:"templates/home.html",controller:"appCtrl"}).when("/content/:id",{templateUrl:"templates/content.html",controller:"contentCtrl"})}).config(function(TokenProvider){TokenProvider.extendConfig({clientId:"859779641004-cvl4ppt05dj26eprlv0eer3hrbmkpudf.apps.googleusercontent.com",redirectUri:"http://localhost:9068/bower_components/angular-oauth/src/oauth2callback.html",scopes:["https://www.googleapis.com/auth/userinfo.email"]})}),angular.module("tvApp").constant("endpoint","http://localhost:8080"),angular.module("tvApp").factory("loginModal",function(btfModal){return btfModal({controller:"loginCtrl",template:'<div class="btf-modal">Hello {{name}}</div>'})}),angular.module("tvApp").factory("ScheduleService",function($http,endpoint){return{get:function(){return $http({method:"GET",url:endpoint+"/api/tv/schedule"}).then(function(response){return response.data})},getId:function(id){return $http({method:"GET",url:endpoint+"/api/tv/schedule"}).then(function(response){return response.data.filter(function(element){return element._id===id})})}}}),angular.module("tvApp").controller("loginCtrl",function($scope,loginModal,$http,Token,$rootScope,$location){$scope.name="Campe√£o",$scope.showModal=function(){console.log("chamou"),loginModal.activate()},$scope.$on("$routeChangeStart",function(){verify()});var verify=function(){console.log(Token),$scope.accessToken=Token.get(),$scope.accessToken&&Token.verifyAsync($scope.accessToken).then(function(){$scope.accessTokenVerified=!0,$http.get("http://localhost:8080/api/web/user",{headers:{Authorization:"Bearer "+$scope.accessToken}}).success(function(data){$scope.user=data,console.log(data)})},function(){console.log("Failed to verify token.")})};$scope.login=function(){Token.extendConfig({state:$location.absUrl()});var extraParams={};Token.getTokenWithRedirect(extraParams)}}),angular.module("tvApp").controller("appCtrl",function($scope,ScheduleService,$location){ScheduleService.get().then(function(data){console.log(data),$scope.coisas=data,$scope.imgDef="http://www.fct.unl.pt/sites/default/files/imagens/noticias/noticias.jpg"}),$scope.go=function(path){$location.path(path)}}),angular.module("tvApp").controller("contentCtrl",function($scope,$routeParams,ScheduleService){console.log($routeParams),$scope.id=$routeParams.id,ScheduleService.getId($routeParams.id).then(function(data){console.log(data),$scope.data=data[0]})}),angular.module("tvApp").directive("youtube",function(){return function(scope,element){scope.$watch("data",function(){var el='<iframe width="853" height="480" id="vidz" src="//www.youtube.com/embed/'+scope.data.videoId+'?enablejsapi=1&version=3&rel=0" frameborder="0"></iframe>';element.html("").append(el)})}});